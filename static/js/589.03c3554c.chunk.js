"use strict";(self.webpackChunkbaby_book=self.webpackChunkbaby_book||[]).push([[589],{8273:function(e,t,n){var r=n(4165),i=n(5861),a=n(1413),s=n(9439),o=n(521),c=n(4941),l=n(8062),u=n(8105),d=n(1095),m=n(9389),h=n(1666),f=n(3122),Z=n(3707),p=n(7943),x=n(3344),j=n(7106),v=n(9286),g=n(2622),w=n(1752),y=n(2791),k=n(438),b=n.n(k),I=n(6957),H=n(3329),S=o.Z.Title,C=o.Z.Text,T=c.Z.Dragger;t.Z=function(e){var t=e.onFinish,n=e.note,o=e.todos,c=e.activities,k=e.formAction,N=e.onDeleteNoteClick,P=e.onBackClick,Y=(0,y.useState)(null===n||void 0===n?void 0:n.imageUrl),D=(0,s.Z)(Y,2),A=D[0],F=D[1],M=(0,y.useState)(!1),q=(0,s.Z)(M,2),U=q[0],G=q[1],L=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"!==t.file.status){e.next=3;break}return G(!0),e.abrupt("return");case 3:"done"===t.file.status&&G(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=(0,H.jsxs)("div",{children:[U?(0,H.jsx)(j.Z,{}):(0,H.jsx)(v.Z,{}),(0,H.jsx)("div",{style:{marginTop:8},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]}),E=(0,y.useMemo)((function(){return"edit"===k?[(0,H.jsxs)("div",{className:"card-actionsWrapper",onClick:function(){n&&N&&N(n.noteId)},children:[(0,H.jsx)(g.Z,{},"delete"),(0,H.jsx)(C,{children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]}),(0,H.jsxs)("div",{className:"card-actionsWrapper",onClick:function(){n&&P&&P(n.imageUrl,A,null===n||void 0===n?void 0:n.imagePath)},children:[(0,H.jsx)(w.Z,{},"edit"),(0,H.jsx)(C,{children:"\u041d\u0430\u0437\u0430\u0434"})]})]:void 0}),[k]);return(0,H.jsx)(u.Z,{hoverable:!0,bordered:!1,style:{width:"100%"},actions:E,title:"edit"===k?"\u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0437\u0430\u043c\u0435\u0442\u043a\u0443":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443",children:(0,H.jsxs)(d.Z,{onFinish:t,initialValues:n?(0,a.Z)((0,a.Z)({},n),{},{date:b()(n.noteDateString,"DD/MM/YYYY"),todos:null===o||void 0===o?void 0:o.map((function(e){return e})),activities:null===c||void 0===c?void 0:c.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{endSleep:b()(e.endSleep,"HH:mm"),eatTime:b()(e.eatTime,"HH:mm"),startSleep:b()(e.startSleep,"HH:mm")})}))}):void 0,children:[(0,H.jsx)(d.Z.Item,{name:"title",rules:[{required:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435!"}],children:(0,H.jsx)(m.Z,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"})}),(0,H.jsx)(d.Z.Item,{name:"date",rules:[{required:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435!"}],children:(0,H.jsx)(h.Z,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u043f\u043e\u0441\u0442\u0430",onChange:function(){},format:"DD/MM/YYYY",style:{width:"100%"}})}),(0,H.jsx)(d.Z.Item,{name:"text",rules:[{required:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435!"}],children:(0,H.jsx)(m.Z.TextArea,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442"})}),(0,H.jsx)(d.Z.Item,{name:"dragger",valuePropName:"file",getValueFromEvent:function(e){return null===e||void 0===e?void 0:e.file.response},children:(0,H.jsx)(T,{multiple:!1,showUploadList:!1,beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||l.ZP.error("\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0444\u043e\u0440\u043c\u0430\u0442\u0430 JPG/PNG!");var n=e.size/1024/1024<6;return n||l.ZP.error("\u0420\u0430\u0437\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 6MB!"),t&&n},onChange:L,customRequest:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onError,n=t.onSuccess,i=t.file,t.filename,a=i,e.next=4,(0,I.G)(a,"".concat(a.uid));case 4:s=e.sent,n&&s&&n({url:s,filePath:a.uid}),F(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:A?(0,H.jsx)(f.Z,{preview:!1,src:A,alt:"avatar",style:{width:"100%"}}):_})}),(0,H.jsx)(S,{level:4,className:"card-title",children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u0435\u043b:"}),(0,H.jsx)(d.Z.List,{name:"todos",children:function(e,t,n){var r=t.add,i=t.remove,s=n.errors;return(0,H.jsxs)(H.Fragment,{children:[e.map((function(t,n){return(0,H.jsxs)(d.Z.Item,{label:n+1,required:!1,children:[(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},t),{},{name:[t.name,"text"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u0434\u0430\u0447\u0443 \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043f\u043e\u043b\u0435"}],noStyle:!0,children:(0,H.jsx)(m.Z,{placeholder:"\u0427\u0442\u043e \u043d\u0443\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c",style:{width:"80%"}})})),e.length>=1?(0,H.jsx)(g.Z,{style:{marginLeft:"1rem",fontSize:"1.2rem"},onClick:function(){return i(t.name)}}):null]},t.key)})),(0,H.jsxs)(d.Z.Item,{children:[(0,H.jsx)(Z.Z,{type:"dashed",onClick:function(){return r()},style:{width:"60%"},icon:(0,H.jsx)(v.Z,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),(0,H.jsx)(Z.Z,{type:"dashed",onClick:function(){r("",0)},style:{width:"80%",marginTop:"20px"},icon:(0,H.jsx)(v.Z,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043d\u0430\u0447\u0430\u043b\u043e \u0441\u043f\u0438\u0441\u043a\u0430"}),(0,H.jsx)(d.Z.ErrorList,{errors:s})]})]})}}),(0,H.jsx)(S,{level:4,className:"card-title",children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c:"}),(0,H.jsx)(d.Z.List,{name:"activities",children:function(e,t){var n=t.add,r=t.remove;return(0,H.jsxs)(H.Fragment,{children:[e.map((function(e){return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u041f\u0440\u043e\u0441\u043d\u0443\u043b\u0441\u044f",name:[e.name,"endSleep"],children:(0,H.jsx)(p.Z,{format:"HH:mm",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f",showNow:!1,style:{width:"100%"}})})),(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u041f\u043e\u0435\u043b",name:[e.name,"eatTime"],children:(0,H.jsx)(p.Z,{format:"HH:mm",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f",showNow:!1,style:{width:"100%"}})})),(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u0421\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0435\u043b",name:[e.name,"eatAmount"],children:(0,H.jsx)(x.Z,{min:0,step:10,style:{width:"100%"}})})),(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u0423\u0441\u043d\u0443\u043b",name:[e.name,"startSleep"],children:(0,H.jsx)(p.Z,{format:"HH:mm",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f",showNow:!1,style:{width:"100%"}})})),(0,H.jsx)(g.Z,{style:{fontSize:"1.2rem",margin:"0 0 1rem 0"},onClick:function(){return r(e.name)}})]})})),(0,H.jsx)(d.Z.Item,{children:(0,H.jsx)(Z.Z,{type:"dashed",onClick:function(){return n()},block:!0,icon:(0,H.jsx)(v.Z,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"})})]})}}),(0,H.jsx)(d.Z.Item,{children:(0,H.jsx)(Z.Z,{type:"primary",htmlType:"submit",children:"edit"===k?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})})}},6957:function(e,t,n){n.d(t,{G:function(){return o},I:function(){return c}});var r=n(4165),i=n(5861),a=n(4453),s=n(3108),o=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,a.iH)(s.t,n),e.next=3,(0,a.KV)(i,t).then((function(e){var t=(0,a.Jt)(e.ref).then((function(e){return e}));return t}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),c=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,a.oq)((0,a.iH)(s.t,"images/".concat(t))).then((function(){console.log("// File deleted successfully")})).catch((function(e){console.log("// Uh-oh, an error occurred!")}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},6589:function(e,t,n){n.r(t);var r=n(4165),i=n(5861),a=n(9439),s=n(2791),o=n(6106),c=n(914),l=n(8273),u=n(5273),d=n(4740),m=n(6188),h=n(6875),f=n(7833),Z=n(6871),p=n(3329);t.default=function(){var e=(0,d.CG)((function(e){return e.auth.userId})),t=(0,Z.s0)(),n=(0,m.pC)(),x=(0,a.Z)(n,1)[0],j=(0,h.jT)(),v=(0,a.Z)(j,1)[0],g=(0,f.mE)(),w=(0,a.Z)(g,1)[0],y=(0,s.useCallback)(function(){var n=(0,i.Z)((0,r.Z)().mark((function n(i){var a,s;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=12;break}return a="Note_".concat((0,u.x0)()),s={title:i.title,text:i.text,noteDateString:i.date.format("DD/MM/YYYY"),noteId:a,imageUrl:i.dragger.url,imagePath:i.dragger.filePath},n.next=5,x({userId:e,newNote:s});case 5:if(!i.todos){n.next=8;break}return n.next=8,Promise.all(i.todos.map((function(t){var n={todoId:"Todo_".concat((0,u.x0)()),noteId:a,text:t};v({userId:e,newTodo:n})})));case 8:if(!i.activities){n.next=11;break}return n.next=11,Promise.all(i.activities.map((function(t){var n={id:"Activity_".concat((0,u.x0)()),noteId:a,eatTime:t.eatTime.format("HH:mm"),endSleep:t.endSleep.format("HH:mm"),startSleep:t.startSleep.format("HH:mm"),eatAmount:t.eatAmount};w({userId:e,newActivity:n})})));case 11:t(-1);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[]);return(0,p.jsx)(o.Z,{justify:"center",align:"middle",className:"mh100 formWrapperPadding",children:(0,p.jsx)(c.Z,{xs:24,md:12,children:(0,p.jsx)(l.Z,{onFinish:y,formAction:"add"})})})}}}]);
//# sourceMappingURL=589.03c3554c.chunk.js.map