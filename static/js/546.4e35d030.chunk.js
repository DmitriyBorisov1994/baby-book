"use strict";(self.webpackChunkbaby_book=self.webpackChunkbaby_book||[]).push([[546],{8273:function(e,t,n){var r=n(4165),i=n(5861),a=n(1413),s=n(9439),o=n(521),c=n(4941),l=n(8062),u=n(8105),d=n(1095),m=n(9389),f=n(1666),p=n(3122),h=n(3707),x=n(7943),Z=n(3344),v=n(7106),j=n(9286),g=n(2622),I=n(1752),k=n(2791),y=n(438),w=n.n(y),b=n(6957),H=n(3329),C=o.Z.Title,S=o.Z.Text,P=c.Z.Dragger;t.Z=function(e){var t=e.onFinish,n=e.note,o=e.todos,c=e.activities,y=e.formAction,T=e.onDeleteNoteClick,N=e.onBackClick,Y=(0,k.useState)(null===n||void 0===n?void 0:n.imageUrl),D=(0,s.Z)(Y,2),q=D[0],A=D[1],F=(0,k.useState)(!1),G=(0,s.Z)(F,2),M=G[0],U=G[1],L=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"!==t.file.status){e.next=3;break}return U(!0),e.abrupt("return");case 3:"done"===t.file.status&&U(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=(0,H.jsxs)("div",{children:[M?(0,H.jsx)(v.Z,{}):(0,H.jsx)(j.Z,{}),(0,H.jsx)("div",{style:{marginTop:8},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]}),E=(0,k.useMemo)((function(){return"edit"===y?[(0,H.jsxs)("div",{className:"card-actionsWrapper",onClick:function(){n&&T&&T(n.noteId)},children:[(0,H.jsx)(g.Z,{},"delete"),(0,H.jsx)(S,{children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]}),(0,H.jsxs)("div",{className:"card-actionsWrapper",onClick:function(){n&&N&&N(n.imageUrl,q,null===n||void 0===n?void 0:n.imagePath)},children:[(0,H.jsx)(I.Z,{},"edit"),(0,H.jsx)(S,{children:"\u041d\u0430\u0437\u0430\u0434"})]})]:void 0}),[y]);return(0,H.jsx)(u.Z,{hoverable:!0,bordered:!1,style:{width:"100%"},actions:E,title:"edit"===y?"\u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0437\u0430\u043c\u0435\u0442\u043a\u0443":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443",children:(0,H.jsxs)(d.Z,{onFinish:t,initialValues:n?(0,a.Z)((0,a.Z)({},n),{},{date:w()(n.noteDateString,"DD/MM/YYYY"),todos:null===o||void 0===o?void 0:o.map((function(e){return e})),activities:null===c||void 0===c?void 0:c.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{endSleep:w()(e.endSleep,"HH:mm"),eatTime:w()(e.eatTime,"HH:mm"),startSleep:w()(e.startSleep,"HH:mm")})}))}):void 0,children:[(0,H.jsx)(d.Z.Item,{name:"title",rules:[{required:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435!"}],children:(0,H.jsx)(m.Z,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"})}),(0,H.jsx)(d.Z.Item,{name:"date",rules:[{required:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435!"}],children:(0,H.jsx)(f.Z,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u043f\u043e\u0441\u0442\u0430",onChange:function(){},format:"DD/MM/YYYY",style:{width:"100%"}})}),(0,H.jsx)(d.Z.Item,{name:"text",rules:[{required:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435!"}],children:(0,H.jsx)(m.Z.TextArea,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442"})}),(0,H.jsx)(d.Z.Item,{name:"dragger",valuePropName:"file",getValueFromEvent:function(e){return null===e||void 0===e?void 0:e.file.response},children:(0,H.jsx)(P,{multiple:!1,showUploadList:!1,beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||l.ZP.error("\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0444\u043e\u0440\u043c\u0430\u0442\u0430 JPG/PNG!");var n=e.size/1024/1024<6;return n||l.ZP.error("\u0420\u0430\u0437\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 6MB!"),t&&n},onChange:L,customRequest:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onError,n=t.onSuccess,i=t.file,t.filename,a=i,e.next=4,(0,b.G)(a,"".concat(a.uid));case 4:s=e.sent,n&&s&&n({url:s,filePath:a.uid}),A(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:q?(0,H.jsx)(p.Z,{preview:!1,src:q,alt:"avatar",style:{width:"100%"}}):B})}),(0,H.jsx)(C,{level:4,className:"card-title",children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u0435\u043b:"}),(0,H.jsx)(d.Z.List,{name:"todos",children:function(e,t,n){var r=t.add,i=t.remove,s=n.errors;return(0,H.jsxs)(H.Fragment,{children:[e.map((function(t,n){return(0,H.jsxs)(d.Z.Item,{label:n+1,required:!1,children:[(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},t),{},{name:[t.name,"text"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u0434\u0430\u0447\u0443 \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043f\u043e\u043b\u0435"}],noStyle:!0,children:(0,H.jsx)(m.Z,{placeholder:"\u0427\u0442\u043e \u043d\u0443\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c",style:{width:"80%"}})})),e.length>=1?(0,H.jsx)(g.Z,{style:{marginLeft:"1rem",fontSize:"1.2rem"},onClick:function(){return i(t.name)}}):null]},t.key)})),(0,H.jsxs)(d.Z.Item,{children:[(0,H.jsx)(h.Z,{type:"dashed",onClick:function(){return r()},style:{width:"60%"},icon:(0,H.jsx)(j.Z,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),(0,H.jsx)(h.Z,{type:"dashed",onClick:function(){r("",0)},style:{width:"80%",marginTop:"20px"},icon:(0,H.jsx)(j.Z,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043d\u0430\u0447\u0430\u043b\u043e \u0441\u043f\u0438\u0441\u043a\u0430"}),(0,H.jsx)(d.Z.ErrorList,{errors:s})]})]})}}),(0,H.jsx)(C,{level:4,className:"card-title",children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c:"}),(0,H.jsx)(d.Z.List,{name:"activities",children:function(e,t){var n=t.add,r=t.remove;return(0,H.jsxs)(H.Fragment,{children:[e.map((function(e){return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u041f\u0440\u043e\u0441\u043d\u0443\u043b\u0441\u044f",name:[e.name,"endSleep"],children:(0,H.jsx)(x.Z,{format:"HH:mm",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f",showNow:!1,style:{width:"100%"}})})),(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u041f\u043e\u0435\u043b",name:[e.name,"eatTime"],children:(0,H.jsx)(x.Z,{format:"HH:mm",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f",showNow:!1,style:{width:"100%"}})})),(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u0421\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0435\u043b",name:[e.name,"eatAmount"],children:(0,H.jsx)(Z.Z,{min:0,step:10,style:{width:"100%"}})})),(0,H.jsx)(d.Z.Item,(0,a.Z)((0,a.Z)({},e),{},{label:"\u0423\u0441\u043d\u0443\u043b",name:[e.name,"startSleep"],children:(0,H.jsx)(x.Z,{format:"HH:mm",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f",showNow:!1,style:{width:"100%"}})})),(0,H.jsx)(g.Z,{style:{fontSize:"1.2rem",margin:"0 0 1rem 0"},onClick:function(){return r(e.name)}})]})})),(0,H.jsx)(d.Z.Item,{children:(0,H.jsx)(h.Z,{type:"dashed",onClick:function(){return n()},block:!0,icon:(0,H.jsx)(j.Z,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"})})]})}}),(0,H.jsx)(d.Z.Item,{children:(0,H.jsx)(h.Z,{type:"primary",htmlType:"submit",children:"edit"===y?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})})}},6957:function(e,t,n){n.d(t,{G:function(){return o},I:function(){return c}});var r=n(4165),i=n(5861),a=n(4453),s=n(3108),o=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,a.iH)(s.t,n),e.next=3,(0,a.KV)(i,t).then((function(e){var t=(0,a.Jt)(e.ref).then((function(e){return e}));return t}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),c=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,a.oq)((0,a.iH)(s.t,"images/".concat(t))).then((function(){console.log("// File deleted successfully")})).catch((function(e){console.log("// Uh-oh, an error occurred!")}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1546:function(e,t,n){n.r(t);var r=n(1413),i=n(4165),a=n(5861),s=n(9439),o=n(2791),c=n(6871),l=n(4740),u=n(6188),d=n(521),m=n(6106),f=n(914),p=n(7833),h=n(6875),x=n(5273),Z=n(8273),v=n(6957),j=n(3329),g=d.Z.Paragraph,I=d.Z.Text;t.default=function(){var e=(0,c.UO)().noteId,t=(0,l.CG)((function(t){if(e)return(0,u.Qg)(t,e)})),n=(0,l.CG)((function(e){if(t)return(0,h.qu)(e,t.noteId)})),d=(0,l.CG)((function(e){if(t)return(0,p.ZK)(e,t.noteId)})),k=(0,c.s0)(),y=(0,u.Pq)(),w=(0,s.Z)(y,1)[0],b=(0,u.wu)(),H=(0,s.Z)(b,1)[0],C=(0,h.jT)(),S=(0,s.Z)(C,1)[0],P=(0,h.wR)(),T=(0,s.Z)(P,1)[0],N=(0,h.q)(),Y=(0,s.Z)(N,1)[0],D=(0,p.mE)(),q=(0,s.Z)(D,1)[0],A=(0,p.cC)(),F=(0,s.Z)(A,1)[0],G=(0,p.XX)(),M=(0,s.Z)(G,1)[0],U=(0,l.CG)((function(e){return e.auth.userId})),L=(0,o.useCallback)(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U){e.next=3;break}return e.next=3,w({userId:U,noteId:t});case 3:if(!n){e.next=6;break}return e.next=6,Promise.all(n.map((function(e){return Y({userId:U,todoId:e.todoId})})));case 6:if(!d){e.next=9;break}return e.next=9,Promise.all(d.map((function(e){return M({userId:U,activityId:e.id})})));case 9:k(-1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[U,e]),B=(0,o.useCallback)(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&n&&t!==n&&r)){e.next=3;break}return e.next=3,(0,v.I)(r);case 3:k(-1);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),[]),E=(0,o.useCallback)(function(){var t=(0,a.Z)((0,i.Z)().mark((function t(a){var s;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!U){t.next=17;break}return s={title:a.title,text:a.text,noteDateString:a.date.format("DD/MM/YYYY"),noteId:e,imageUrl:a.dragger.url,imagePath:a.dragger.filePath},t.next=4,H({userId:U,updatedNote:s});case 4:if(!a.todos){t.next=10;break}return t.next=7,Promise.all(a.todos.map((function(t){if(t.todoId)T({userId:U,todo:t});else{var n={todoId:"Todo_".concat((0,x.x0)()),noteId:e,text:t.text};S({userId:U,newTodo:n})}})));case 7:if(!n){t.next=10;break}return t.next=10,Promise.all(n.map((function(e){a.todos.find((function(t){return t.todoId=e.todoId}))||Y({userId:U,id:e.todoId})})));case 10:if(!a.activities){t.next=16;break}return t.next=13,Promise.all(a.activities.map((function(t){if(t.id){var n=(0,r.Z)((0,r.Z)({},t),{},{eatTime:t.eatTime.format("HH:mm"),endSleep:t.endSleep.format("HH:mm"),startSleep:t.startSleep.format("HH:mm")});F({userId:U,updatedActivity:n})}else{var i={id:"Activity_".concat((0,x.x0)()),noteId:e,eatTime:t.eatTime.format("HH:mm"),endSleep:t.endSleep.format("HH:mm"),startSleep:t.startSleep.format("HH:mm"),eatAmount:t.eatAmount};q({userId:U,newActivity:i})}})));case 13:if(!d){t.next=16;break}return t.next=16,Promise.all(d.map((function(e){a.activities.find((function(t){return t.id=e.id}))||M({userId:U,id:e.id})})));case 16:k(-1);case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),_=t?(0,j.jsx)(Z.Z,{onFinish:E,note:t,todos:n,activities:d,formAction:"edit",onDeleteNoteClick:L,onBackClick:B}):(0,j.jsx)(g,{style:{textAlign:"center"},children:(0,j.jsx)(I,{type:"secondary",strong:!0,children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430!"})});return(0,j.jsx)(m.Z,{justify:"center",align:"middle",className:"mh100 formWrapperPadding",children:(0,j.jsx)(f.Z,{xs:24,md:12,children:_})})}}}]);
//# sourceMappingURL=546.4e35d030.chunk.js.map